<?php

namespace App\Http\Controllers;

use Inertia\Inertia;
use App\Models\UserAuth;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;

class CitizenController extends Controller
{
    public function index()
    {
        $citizens = UserAuth::with('profile')->paginate(20);
        return Inertia::render('Citizens/index', ['citizens' => $citizens]);
    }


    public function show(UserAuth $citizen)
    {
        $citizen->load('profile', 'userIdentity');

        $photo = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAIAAABMXPacAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGNzZERkI1MzkwNkMxMUVCQkFCNzk3OEVGQzc4QjQ4QSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGNzZERkI1NDkwNkMxMUVCQkFCNzk3OEVGQzc4QjQ4QSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkY3NkRGQjUxOTA2QzExRUJCQUI3OTc4RUZDNzhCNDhBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY3NkRGQjUyOTA2QzExRUJCQUI3OTc4RUZDNzhCNDhBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+17umTgAAC91JREFUeNrsXXlQjd8b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';
        // try {
        //     $photo = getProfilePhoto($citizen->profile->date_of_birth, $citizen->citizen_id);
        // } catch (\Throwable $th) {
        //     $photo = '';
        //     // return response(['success' => false, 'data' => '', 'message' => $th->getMessage()], 422);
        // }
        return Inertia::render('Citizens/Details', ['user' => $citizen, 'photo' => $photo]);
    }


    public function modal()
    {
        return Inertia::render('Modals/Index');
    }
}